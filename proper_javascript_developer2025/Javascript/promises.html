<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promise in javascript</title>
</head>
<body>
        <h1>promises in javascript</h1>
        <script>
            // promise is a special object 
            const promise = new Promise((resolve,reject)=>{
                resolve('am from data')
            });
            
            promise.then((data)=>{
                // console.log(data)
                // console.log('hello resolve')
            })

            // fix call back hell using promises 

           
            function makeHttpRequest(method,url){
                 const xhr = new XMLHttpRequest();
            xhr.responseType ='json';
           
            const pro = new Promise((resolve,reject)=>{
            xhr.addEventListener('load',()=>{
                    resolve(xhr.response);
               });
            xhr.addEventListener('error',()=>{
                reject('request regectd')
            })
               
            })
            
            xhr.open(method,url);
            xhr.send();
            return pro;
            }

            // makeHttpRequest("GET","https://dummyjson.com/users",(usersData)=>{
            //     console.log(usersData.users[0].id)
            //     makeHttpRequest("GET",`https://dummyjson.com/posts/${usersData.users[0].id}`,(post)=>{
            //         console.log(post)
            //         makeHttpRequest("GET",`https://dummyjson.com/comments/${usersData.users[0].id}`,(comments)=>{
            //             console.log(comments)
            //         })
            //     })
            // });

            // lets fix callback hell

            makeHttpRequest("GET","https://dummyjson.com/users")
           .then((usersData)=>{
             console.log(usersData.users[0].id)
             return makeHttpRequest("GET",`https://dummyjson.com/posts/${usersData.users[0].id}`)
           }).then((posts)=>{
                console.log(posts)
                return  makeHttpRequest("GET",`https://dummyjson.com/comments/`)
           }).then((comments)=>{
                console.log(comments.comments[0])
           }).catch((err)=>{
                console.log(err)
           })
        </script>
</body>
</html>